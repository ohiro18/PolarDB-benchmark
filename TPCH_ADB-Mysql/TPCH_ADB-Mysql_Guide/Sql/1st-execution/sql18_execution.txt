mysql> select
    ->         c_name,
    ->         c_custkey,
    ->         o_orderkey,
    ->         o_orderdate,
    ->         o_totalprice,
    ->         sum(l_quantity)
    -> from
    ->         customer,
    ->         orders,
    ->         lineitem
    -> where
    ->         o_orderkey in (
    ->                 select
    ->                         l_orderkey
    ->                 from
    ->                         lineitem
    ->                 group by
    ->                         l_orderkey having
    ->                                 sum(l_quantity) > 312
    ->         )
    ->         and c_custkey = o_custkey
    ->         and o_orderkey = l_orderkey
    -> group by
    ->         c_name,
    ->         c_custkey,
    ->         o_orderkey,
    ->         o_orderdate,
    ->         o_totalprice
    -> order by
    ->         o_totalprice desc,
    ->         o_orderdate
    -> limit 100;
+--------------------+-----------+------------+-------------+--------------+-----------------+
| c_name             | c_custkey | o_orderkey | o_orderdate | o_totalprice | sum(l_quantity) |
+--------------------+-----------+------------+-------------+--------------+-----------------+
| Customer#011472112 |  11472112 |  458304292 | 1998-02-05  |    591036.15 |          322.00 |
| Customer#012090925 |  12090925 |  501322081 | 1995-02-04  |    586945.44 |          319.00 |
| Customer#013458721 |  13458721 |  333307747 | 1997-12-19  |    572334.88 |          319.00 |
| Customer#008643083 |   8643083 |   84927619 | 1997-06-29  |    571417.48 |          316.00 |
| Customer#010543705 |  10543705 |  163142919 | 1996-06-10  |    569798.10 |          313.00 |
| Customer#005914657 |   5914657 |   55799200 | 1996-02-11  |    568754.48 |          327.00 |
| Customer#011461310 |  11461310 |   20662370 | 1992-07-22  |    566353.20 |          315.00 |
| Customer#007682894 |   7682894 |  532736640 | 1993-07-22  |    563532.16 |          316.00 |
| Customer#012070685 |  12070685 |   34201984 | 1997-06-18  |    563492.49 |          322.00 |
| Customer#012878113 |  12878113 |   42290181 | 1997-11-26  |    563479.57 |          318.00 |
| Customer#000506836 |    506836 |  116567399 | 1992-03-21  |    563342.71 |          319.00 |
| Customer#012848143 |  12848143 |  501771233 | 1994-12-06  |    562642.03 |          317.00 |
| Customer#003493022 |   3493022 |  182898470 | 1996-01-09  |    561296.06 |          318.00 |
| Customer#013083751 |  13083751 |   28077922 | 1996-10-27  |    560893.88 |          319.00 |
| Customer#006580315 |   6580315 |  343593507 | 1994-05-20  |    560058.60 |          321.00 |
| Customer#009427249 |   9427249 |   48881602 | 1993-09-19  |    559502.82 |          327.00 |
| Customer#006594658 |   6594658 |  555833473 | 1997-08-01  |    557961.99 |          324.00 |
| Customer#005925541 |   5925541 |  446215044 | 1992-05-13  |    556993.03 |          318.00 |
| Customer#007010650 |   7010650 |  587222276 | 1993-12-17  |    555946.71 |          329.00 |
| Customer#008211575 |   8211575 |  218305350 | 1992-12-19  |    555691.15 |          316.00 |
| Customer#005523215 |   5523215 |  499594150 | 1997-12-30  |    552295.59 |          322.00 |
| Customer#006048598 |   6048598 |   45897379 | 1994-05-30  |    550195.48 |          318.00 |
| Customer#013889867 |  13889867 |  322196069 | 1992-12-24  |    549996.06 |          313.00 |
| Customer#003262783 |   3262783 |  327814241 | 1997-04-16  |    548355.89 |          319.00 |
| Customer#002099413 |   2099413 |  507968289 | 1993-01-23  |    547809.74 |          316.00 |
| Customer#005800261 |   5800261 |  493616454 | 1997-01-11  |    547151.89 |          314.00 |
| Customer#012179552 |  12179552 |  157723879 | 1992-01-06  |    545008.93 |          320.00 |
| Customer#000328568 |    328568 |  584293472 | 1997-02-04  |    544997.41 |          317.00 |
| Customer#005098117 |   5098117 |   82043264 | 1996-04-15  |    544838.33 |          330.00 |
| Customer#006394964 |   6394964 |  410876964 | 1994-11-15  |    543654.37 |          324.00 |
| Customer#005021956 |   5021956 |  163897538 | 1992-05-10  |    543411.84 |          315.00 |
| Customer#014745380 |  14745380 |  323533249 | 1993-03-31  |    543411.82 |          322.00 |
| Customer#001070318 |   1070318 |   91475014 | 1996-11-15  |    542874.97 |          314.00 |
| Customer#000793051 |    793051 |  103963585 | 1996-10-27  |    540445.27 |          313.00 |
| Customer#010763563 |  10763563 |  575451169 | 1994-01-18  |    539403.56 |          329.00 |
| Customer#008402254 |   8402254 |  539392967 | 1993-02-23  |    538886.31 |          333.00 |
| Customer#008654869 |   8654869 |  100176839 | 1993-04-12  |    538846.61 |          317.00 |
| Customer#014286853 |  14286853 |  423877508 | 1995-03-02  |    536949.18 |          319.00 |
| Customer#008779822 |   8779822 |  211965092 | 1996-07-18  |    536768.43 |          314.00 |
| Customer#008208034 |   8208034 |  446989058 | 1993-07-12  |    536601.61 |          315.00 |
| Customer#009666952 |   9666952 |  475794275 | 1994-09-23  |    536427.97 |          322.00 |
| Customer#014831182 |  14831182 |   92086567 | 1996-06-12  |    536294.92 |          322.00 |
| Customer#013677323 |  13677323 |  387783079 | 1992-04-22  |    535504.63 |          316.00 |
| Customer#004663856 |   4663856 |  159914310 | 1996-09-12  |    535322.28 |          315.00 |
| Customer#000299162 |    299162 |  303098309 | 1996-01-28  |    534421.58 |          315.00 |
| Customer#005747806 |   5747806 |  540886884 | 1994-04-14  |    534288.51 |          314.00 |
| Customer#013094119 |  13094119 |  111128577 | 1995-05-09  |    534239.89 |          316.00 |
| Customer#012726752 |  12726752 |   92511430 | 1995-03-06  |    533441.05 |          318.00 |
| Customer#011219830 |  11219830 |  156065860 | 1996-07-03  |    533119.17 |          325.00 |
| Customer#014112568 |  14112568 |  280056096 | 1997-01-30  |    532881.87 |          313.00 |
| Customer#013477537 |  13477537 |  175859779 | 1997-04-14  |    532574.30 |          325.00 |
| Customer#003082444 |   3082444 |  319083271 | 1993-03-24  |    532223.76 |          315.00 |
| Customer#010716088 |  10716088 |  275341121 | 1994-07-15  |    532037.67 |          326.00 |
| Customer#009444602 |   9444602 |  177770599 | 1992-01-28  |    531961.40 |          337.00 |
| Customer#013616422 |  13616422 |  329431840 | 1995-09-05  |    531857.34 |          316.00 |
| Customer#000155713 |    155713 |  531652866 | 1996-06-18  |    531350.79 |          326.00 |
| Customer#004808569 |   4808569 |   12809282 | 1994-05-21  |    531002.73 |          314.00 |
| Customer#013300369 |  13300369 |  559711910 | 1993-03-25  |    530710.84 |          324.00 |
| Customer#003172843 |   3172843 |   44178691 | 1998-01-24  |    530083.88 |          316.00 |
| Customer#014675531 |  14675531 |  358712709 | 1996-01-15  |    529299.34 |          314.00 |
| Customer#007404905 |   7404905 |   87006309 | 1992-11-21  |    529089.99 |          320.00 |
| Customer#007773805 |   7773805 |  261498084 | 1993-12-24  |    528495.53 |          319.00 |
| Customer#014160562 |  14160562 |  525435843 | 1994-04-25  |    527900.25 |          313.00 |
| Customer#009668443 |   9668443 |  327357765 | 1995-02-22  |    527800.90 |          325.00 |
| Customer#006125536 |   6125536 |  532672775 | 1993-12-16  |    527552.58 |          326.00 |
| Customer#004041908 |   4041908 |   99667621 | 1992-10-25  |    526326.09 |          317.00 |
| Customer#006541660 |   6541660 |  130130438 | 1992-03-31  |    525783.23 |          324.00 |
| Customer#012270997 |  12270997 |   35542498 | 1993-10-12  |    525713.29 |          325.00 |
| Customer#007789483 |   7789483 |   40876003 | 1992-05-10  |    525433.70 |          314.00 |
| Customer#002620171 |   2620171 |  546228576 | 1994-11-28  |    524372.13 |          325.00 |
| Customer#011942315 |  11942315 |  137209030 | 1993-07-14  |    524187.78 |          323.00 |
| Customer#013455998 |  13455998 |  483724192 | 1997-03-04  |    523481.16 |          314.00 |
| Customer#007051187 |   7051187 |  138606375 | 1997-07-24  |    522926.52 |          318.00 |
| Customer#002021647 |   2021647 |  309781410 | 1995-04-12  |    521591.50 |          313.00 |
| Customer#005861503 |   5861503 |  395809221 | 1996-03-11  |    520971.04 |          314.00 |
| Customer#002667464 |   2667464 |   41274690 | 1992-08-10  |    520813.13 |          317.00 |
| Customer#007297621 |   7297621 |  442178406 | 1998-01-30  |    520565.56 |          318.00 |
| Customer#014874056 |  14874056 |  468303910 | 1998-01-29  |    519999.41 |          314.00 |
| Customer#012912623 |  12912623 |  187711367 | 1995-08-17  |    519950.45 |          325.00 |
| Customer#008050909 |   8050909 |  260432385 | 1994-09-13  |    519518.68 |          324.00 |
| Customer#007354688 |   7354688 |  584032992 | 1992-02-01  |    518933.52 |          316.00 |
| Customer#010930157 |  10930157 |  232919687 | 1997-05-21  |    518754.11 |          334.00 |
| Customer#006014731 |   6014731 |  161387302 | 1997-06-19  |    518719.77 |          314.00 |
| Customer#000280583 |    280583 |  224453441 | 1998-03-10  |    518616.51 |          318.00 |
| Customer#000040175 |     40175 |  507136258 | 1992-02-01  |    518497.04 |          317.00 |
| Customer#000358255 |    358255 |  396154496 | 1992-01-17  |    518095.13 |          317.00 |
| Customer#005907479 |   5907479 |  495435649 | 1992-05-07  |    517990.12 |          313.00 |
| Customer#008149051 |   8149051 |  127825121 | 1995-04-16  |    517895.56 |          320.00 |
| Customer#004261654 |   4261654 |  455281089 | 1997-09-08  |    517667.92 |          313.00 |
| Customer#004493219 |   4493219 |  146084455 | 1992-08-21  |    517549.01 |          313.00 |
| Customer#009049549 |   9049549 |  323219458 | 1994-04-02  |    517408.68 |          315.00 |
| Customer#013163174 |  13163174 |  546761091 | 1998-02-06  |    517316.41 |          316.00 |
| Customer#014141798 |  14141798 |  531081185 | 1996-06-08  |    516399.57 |          321.00 |
| Customer#011173516 |  11173516 |  143875140 | 1998-06-09  |    516258.94 |          315.00 |
| Customer#004621336 |   4621336 |  294701219 | 1993-05-10  |    516081.84 |          315.00 |
| Customer#009433798 |   9433798 |  469098182 | 1997-10-17  |    516024.87 |          317.00 |
| Customer#011719279 |  11719279 |  162040167 | 1998-05-04  |    515755.61 |          313.00 |
| Customer#009814556 |   9814556 |   20971013 | 1997-08-12  |    515684.69 |          322.00 |
| Customer#008605375 |   8605375 |  595511555 | 1993-08-12  |    515645.46 |          314.00 |
| Customer#014111593 |  14111593 |  233925702 | 1993-08-23  |    515501.24 |          318.00 |
+--------------------+-----------+------------+-------------+--------------+-----------------+
100 rows in set (15.65 sec)
