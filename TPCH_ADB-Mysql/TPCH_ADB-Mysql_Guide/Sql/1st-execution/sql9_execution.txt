mysql> select
    ->         nation,
    ->         o_year,
    ->         sum(amount) as sum_profit
    -> from
    ->         (
    ->                 select
    ->                         n_name as nation,
    ->                         extract(year from o_orderdate) as o_year,
    ->                         l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
    ->                 from
    ->                         part,
    ->                         supplier,
    ->                         lineitem,
    ->                         partsupp,
    ->                         orders,
    ->                         nation
    ->                 where
    ->                         s_suppkey = l_suppkey
    ->                         and ps_suppkey = l_suppkey
    ->                         and ps_partkey = l_partkey
    ->                         and p_partkey = l_partkey
    ->                         and o_orderkey = l_orderkey
    ->                         and s_nationkey = n_nationkey
    ->                         and p_name like '%maroon%'
    ->         ) as profit
    -> group by
    ->         nation,
    ->         o_year
    -> order by
    ->         nation,
    ->         o_year desc;
+----------------+--------+-----------------+
| nation         | o_year | sum_profit      |
+----------------+--------+-----------------+
| ALGERIA        |   1998 | 2720594230.1803 |
| ALGERIA        |   1997 | 4654961873.9242 |
| ALGERIA        |   1996 | 4680012407.4261 |
| ALGERIA        |   1995 | 4659697270.6760 |
| ALGERIA        |   1994 | 4635157949.3008 |
| ALGERIA        |   1993 | 4649704017.4265 |
| ALGERIA        |   1992 | 4643100777.0422 |
| ARGENTINA      |   1998 | 2698914879.7325 |
| ARGENTINA      |   1997 | 4637343262.8659 |
| ARGENTINA      |   1996 | 4651780956.7261 |
| ARGENTINA      |   1995 | 4611704865.0426 |
| ARGENTINA      |   1994 | 4635320578.1357 |
| ARGENTINA      |   1993 | 4633294188.6940 |
| ARGENTINA      |   1992 | 4642855705.9823 |
| BRAZIL         |   1998 | 2751163575.0790 |
| BRAZIL         |   1997 | 4637791296.6352 |
| BRAZIL         |   1996 | 4683733653.0234 |
| BRAZIL         |   1995 | 4657382145.9503 |
| BRAZIL         |   1994 | 4665068700.0852 |
| BRAZIL         |   1993 | 4651447017.3472 |
| BRAZIL         |   1992 | 4675697278.1436 |
| CANADA         |   1998 | 2719675016.7356 |
| CANADA         |   1997 | 4656441425.0684 |
| CANADA         |   1996 | 4681740213.1713 |
| CANADA         |   1995 | 4657333669.2448 |
| CANADA         |   1994 | 4666088402.6416 |
| CANADA         |   1993 | 4652626042.8864 |
| CANADA         |   1992 | 4662009501.4926 |
| CHINA          |   1998 | 2721142163.3392 |
| CHINA          |   1997 | 4630504156.8966 |
| CHINA          |   1996 | 4671786284.2874 |
| CHINA          |   1995 | 4655311428.0570 |
| CHINA          |   1994 | 4648308498.5788 |
| CHINA          |   1993 | 4632834886.7481 |
| CHINA          |   1992 | 4640226331.3761 |
| EGYPT          |   1998 | 2722534768.4108 |
| EGYPT          |   1997 | 4654295554.9412 |
| EGYPT          |   1996 | 4677614910.4200 |
| EGYPT          |   1995 | 4673883550.7014 |
| EGYPT          |   1994 | 4645850744.6913 |
| EGYPT          |   1993 | 4665855817.2357 |
| EGYPT          |   1992 | 4671893916.1672 |
| ETHIOPIA       |   1998 | 2741807457.2636 |
| ETHIOPIA       |   1997 | 4657307161.4885 |
| ETHIOPIA       |   1996 | 4690261950.5124 |
| ETHIOPIA       |   1995 | 4684011159.0662 |
| ETHIOPIA       |   1994 | 4682764153.5029 |
| ETHIOPIA       |   1993 | 4678234481.4824 |
| ETHIOPIA       |   1992 | 4686774470.1727 |
| FRANCE         |   1998 | 2742259365.4996 |
| FRANCE         |   1997 | 4692428673.3667 |
| FRANCE         |   1996 | 4670002197.8056 |
| FRANCE         |   1995 | 4667881479.1230 |
| FRANCE         |   1994 | 4652829536.1837 |
| FRANCE         |   1993 | 4649312374.6516 |
| FRANCE         |   1992 | 4698243078.2963 |
| GERMANY        |   1998 | 2759906507.5978 |
| GERMANY        |   1997 | 4717739696.1996 |
| GERMANY        |   1996 | 4699196938.2802 |
| GERMANY        |   1995 | 4687165484.0653 |
| GERMANY        |   1994 | 4693585505.6763 |
| GERMANY        |   1993 | 4691022777.0950 |
| GERMANY        |   1992 | 4690583890.3940 |
| INDIA          |   1998 | 2728387254.9597 |
| INDIA          |   1997 | 4661156011.8460 |
| INDIA          |   1996 | 4669286732.3803 |
| INDIA          |   1995 | 4654348465.3845 |
| INDIA          |   1994 | 4664419912.7405 |
| INDIA          |   1993 | 4642648917.5009 |
| INDIA          |   1992 | 4674220481.4255 |
| INDONESIA      |   1998 | 2708093755.6950 |
| INDONESIA      |   1997 | 4618308482.1130 |
| INDONESIA      |   1996 | 4632344118.6264 |
| INDONESIA      |   1995 | 4614206443.3184 |
| INDONESIA      |   1994 | 4622677476.7597 |
| INDONESIA      |   1993 | 4610283748.2734 |
| INDONESIA      |   1992 | 4642484948.4472 |
| IRAN           |   1998 | 2728974764.3116 |
| IRAN           |   1997 | 4661582138.1045 |
| IRAN           |   1996 | 4665439654.7433 |
| IRAN           |   1995 | 4655360259.4598 |
| IRAN           |   1994 | 4642940704.6467 |
| IRAN           |   1993 | 4625284292.7508 |
| IRAN           |   1992 | 4651802779.6154 |
| IRAQ           |   1998 | 2733714186.3045 |
| IRAQ           |   1997 | 4637691570.4051 |
| IRAQ           |   1996 | 4676786142.8458 |
| IRAQ           |   1995 | 4679201013.1600 |
| IRAQ           |   1994 | 4646703350.4083 |
| IRAQ           |   1993 | 4662155669.4975 |
| IRAQ           |   1992 | 4670797300.8301 |
| JAPAN          |   1998 | 2709032993.5150 |
| JAPAN          |   1997 | 4630178962.9527 |
| JAPAN          |   1996 | 4653698056.3822 |
| JAPAN          |   1995 | 4641319449.0679 |
| JAPAN          |   1994 | 4645470412.5242 |
| JAPAN          |   1993 | 4593652298.3981 |
| JAPAN          |   1992 | 4646892744.7047 |
| JORDAN         |   1998 | 2717344915.8669 |
| JORDAN         |   1997 | 4647781276.2027 |
| JORDAN         |   1996 | 4687854063.4837 |
| JORDAN         |   1995 | 4635315454.6288 |
| JORDAN         |   1994 | 4656246210.8260 |
| JORDAN         |   1993 | 4651546750.9857 |
| JORDAN         |   1992 | 4653584251.6845 |
| KENYA          |   1998 | 2711381928.0482 |
| KENYA          |   1997 | 4623877097.1168 |
| KENYA          |   1996 | 4630899296.2355 |
| KENYA          |   1995 | 4632725728.3664 |
| KENYA          |   1994 | 4631622881.5969 |
| KENYA          |   1993 | 4642797525.9623 |
| KENYA          |   1992 | 4651557659.2576 |
| MOROCCO        |   1998 | 2728242607.6682 |
| MOROCCO        |   1997 | 4657966662.2447 |
| MOROCCO        |   1996 | 4694097580.5503 |
| MOROCCO        |   1995 | 4643575823.7638 |
| MOROCCO        |   1994 | 4636384480.7694 |
| MOROCCO        |   1993 | 4663691290.6480 |
| MOROCCO        |   1992 | 4675474807.4466 |
| MOZAMBIQUE     |   1998 | 2735498615.1580 |
| MOZAMBIQUE     |   1997 | 4674677625.7448 |
| MOZAMBIQUE     |   1996 | 4689953996.0785 |
| MOZAMBIQUE     |   1995 | 4667341478.6796 |
| MOZAMBIQUE     |   1994 | 4675215672.7492 |
| MOZAMBIQUE     |   1993 | 4658248429.3456 |
| MOZAMBIQUE     |   1992 | 4706270989.1027 |
| PERU           |   1998 | 2708320670.7703 |
| PERU           |   1997 | 4638175267.7070 |
| PERU           |   1996 | 4635395861.8161 |
| PERU           |   1995 | 4620780230.5527 |
| PERU           |   1994 | 4625512492.3930 |
| PERU           |   1993 | 4592665616.5394 |
| PERU           |   1992 | 4627985673.6150 |
| ROMANIA        |   1998 | 2755519400.5771 |
| ROMANIA        |   1997 | 4673698086.1271 |
| ROMANIA        |   1996 | 4683313933.9017 |
| ROMANIA        |   1995 | 4680603378.7992 |
| ROMANIA        |   1994 | 4664116508.6719 |
| ROMANIA        |   1993 | 4678174596.5955 |
| ROMANIA        |   1992 | 4712881116.6327 |
| RUSSIA         |   1998 | 2726410405.1298 |
| RUSSIA         |   1997 | 4658204549.6404 |
| RUSSIA         |   1996 | 4661367033.0736 |
| RUSSIA         |   1995 | 4646334261.1443 |
| RUSSIA         |   1994 | 4648801470.6331 |
| RUSSIA         |   1993 | 4665298400.0667 |
| RUSSIA         |   1992 | 4667304278.4658 |
| SAUDI ARABIA   |   1998 | 2709539513.9529 |
| SAUDI ARABIA   |   1997 | 4667365176.1091 |
| SAUDI ARABIA   |   1996 | 4669714155.9476 |
| SAUDI ARABIA   |   1995 | 4633929664.8610 |
| SAUDI ARABIA   |   1994 | 4631183366.1818 |
| SAUDI ARABIA   |   1993 | 4624826020.9980 |
| SAUDI ARABIA   |   1992 | 4647430441.5374 |
| UNITED KINGDOM |   1998 | 2771445741.1879 |
| UNITED KINGDOM |   1997 | 4717720096.4921 |
| UNITED KINGDOM |   1996 | 4718164333.3596 |
| UNITED KINGDOM |   1995 | 4723329958.6422 |
| UNITED KINGDOM |   1994 | 4722222402.4023 |
| UNITED KINGDOM |   1993 | 4720301903.8479 |
| UNITED KINGDOM |   1992 | 4738830605.4515 |
| UNITED STATES  |   1998 | 2746056103.0510 |
| UNITED STATES  |   1997 | 4680426790.0738 |
| UNITED STATES  |   1996 | 4699099844.7089 |
| UNITED STATES  |   1995 | 4657649498.0957 |
| UNITED STATES  |   1994 | 4685406780.0476 |
| UNITED STATES  |   1993 | 4665182664.7178 |
| UNITED STATES  |   1992 | 4695861382.4181 |
| VIETNAM        |   1998 | 2742491558.6433 |
| VIETNAM        |   1997 | 4670173357.7348 |
| VIETNAM        |   1996 | 4678380868.6099 |
| VIETNAM        |   1995 | 4683441292.1630 |
| VIETNAM        |   1994 | 4676572643.4893 |
| VIETNAM        |   1993 | 4669474194.8125 |
| VIETNAM        |   1992 | 4682544488.6567 |
+----------------+--------+-----------------+
175 rows in set (36.88 sec)
